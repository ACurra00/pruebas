{% extends "shared/base_homepages.html" %}

    {% block content %}
    <section class="section-header overflow-hidden pt-7 pt-lg-6 pb-9 pb-lg-0 bg-primary text-white">
    </section>

    <div class="section section-sm pb-0 mb-n4">
      <div class="container">
          <div class="row justify-content-center">
              <h1 class="text-center">Carnets Entregados</h3>
          </div>
           <div style="text-align: center;">
             <small style="color: #FF0000; font-size: 16px;" type="error_nada" id="error_nada" name="error_nada" class="form-text text-gray">{{error_nada}}</small>
            </div>
      </div>
  </div>

    <div class="section section-md">
      <div class="container">
          <div class="row justify-content-center">
              <div class="col-lg-12">
                  <div class="mb-5">
                      <div class="mb-4">
                        <div id="result" class="text-bold lead"></div>
                      </div>
                      <form>
                        <label for="filtro1">Buscar por CI: </label>
                        <input type="text" pattern="^\d{11}$" title="El carnet debe estar conformado por 11 dígitos, no deje margen ni espacios en blanco" name="filtro1" id="filtro1">

                        <label for="filtro2"> Buscar por Área</label>
                        <input type="text" pattern="^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+$" title="Solo debe tener letras" name="filtro2" id="filtro2">

                        <label for="filtro3"> Buscar por Nombre</label>
                        <input type="text" pattern="^[a-zA-Z-ZáéíóúÁÉÍÓÚñÑ\s]+$" title="Solo debe tener letras" name="filtro3" id="filtro3">
                
                        <button type="submit">Filtrar</button>
                    </form>
                    <script>
                              const form = document.querySelector("form");

                              form.addEventListener("submit", (event) => {
                                  event.preventDefault();
                                  const filtro1 = document.querySelector("#filtro1").value;
                                  const filtro2 = document.querySelector("#filtro2").value;
                                  const filtro3 = document.querySelector("#filtro3").value;
                                  const url = `/carnets/entregados/?filtro1=${filtro1}&filtro2=${filtro2}&filtro3=${filtro3}`;
                                  window.location.href = url;
                              });
                    </script>
                      <table class="table table-hover" name = "table1" id="table1">
                          <tr>
                              <th scope="col" id="class3">Folio</th>
                              <th scope="col" id="teacher3">Carnet de identidad</th>
                              <th scope="col" id="teacher3">Nombre</th>
                              <th scope="col" id="females3">Area</th>
                              <th scope="col">Rol</th>
                              <th scope="col">Tipo de motivo</th>
                              <th scope="col">Comprobante</th>
                              <th scope="col">Fecha</th>
                          </tr>
                          <tr>
                            {% for carnet in page_obj %}
                              <td>{{ carnet.folio }}</td>
                              <td>{{ carnet.person_ci }}</td>
                              {% for person in persons %}
                                {% if carnet.person_ci == person.ci -%}
                                  <td>{{ person.nombre }}</td>
                                  <td>{{ person.area }}</td>
                                  <td>{{ person.rol }}</td>
                                {%- endif %}
                               {% endfor %}
                               {% for motivo in motivos %}
                                  {% if carnet.tipo_motivo_id == motivo.id_motivo -%}
                                    <td>{{ motivo.nombre_motivo }}</td>
                                  {%- endif %}
                                {% endfor %}  
                              <td>{{ carnet.comprobante_motivo }}</td>
                              <td>{{ carnet.fecha }}</td>
                          </tr>
                          {% endfor %}
                      </table>
                  </div>
                     </div>
                     <div class="pagination">
                      <span class="step-links">
                          {% if page_obj.has_previous %}
                              <a href="?page=1">&laquo; first</a>
                              <a href="?page={{ page_obj.number-1}}">  --previous  </a>
                          {% endif %}
          
                          <span class="current">
                              Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                          </span>
          
                          {% if page_obj.has_next %}
                              <a href="?page={{page_obj.number+1}}"> next++  </a>
                              <a href="?page={{page_obj.paginator.num_pages}}"> last &raquo;</a>
                          {% endif %}
                      </span>
                  </div>
          </div>
      </div>
  </div>

  {% include 'includes/footer.html' %} 
  {% endblock %}

{% block javascripts %}


</script>
{% endblock javascripts %}

                      